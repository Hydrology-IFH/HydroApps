{% extends 'kombstra/base.html' %}
{% load static %}
{% load i18n %}

{% block head %}
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
{% endblock %}

{% block content %}

  <h1>{% trans "KombStRA map" %}</h1>
  <div class="container">
    <div class="row">
      <div class="col-md-7 col-12" >
        <div id="map" style="height: 80vh"></div>
      </div>
      <div class="col-md-5 col-12">
        <div class="container">
          <form id="form_select_grid" class="form-horizontal" action="javascript:void(0);">
            <div class="d-flex col-12">
              <p>{% trans "Select the KombStRA data to show on the map. To get more information on single fields, just click on the raster cell on the map." %}</p>
            </div>

            <div class="form-group input-group mb-3">
              <span class="input-group-text" id="label_parameter" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body"
              data-bs-html="true" data-bs-title='{% trans "Choose the Parameters you would like to see on the map." %}'>{% trans "Parameter" %}</span>
              <select class="form-select" id="parameter" name="parameter" >
                <option value="duration" selected>{% trans "duration" %}</option>
                <option value="pval">{% trans "rain intensity" %}</option>
                <option value="sri">{% trans "heavy rain index (SRI)" %}</option>
                <option value="year">{% trans "year" %}</option>
                <option value="month">{% trans "month" %}</option>
              </select>
              <div class="bs-component" id="agg_alert_box"></div>
            </div>


            <div class="form-group input-group mb-3">
              <span class="input-group-text" id="label_parameter" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body"
              data-bs-html="true" data-bs-title='{% trans "Choose the percentile you would like to see on the map." %}'>{% trans "Percentile" %}</span>
              <select class="form-select" id="percentile" name="percentile">
                <option value="10">10 %</option>
                <option value="50" selected>50 %</option>
                <option value="90">90 %</option>
              </select>
            </div>

            <div class="form-group input-group mb-3">
              <span class="input-group-text" id="label_eventRank" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body"
              data-bs-html="true" data-bs-title='{% trans "Choose the rank of the event. E.g. the Top 1 event per grid cell." %}'>{% trans "Event rank" %}</span>
              <span class="form-control">
                <input type="range" class="form-range" name="eventRankRange" id="eventRank" min="1" max="20" value="1" oninput="this.form.eventRankNumber.value=this.value" />
              </span>
              <input type="number" class="form-control" name="eventRankNumber" min="1" max="20" value="1" oninput="this.form.eventRankRange.value=this.value" style="max-width:70px" />
            </div>
          </form>
          <form id="form_map_settings" class="form-horizontal" action="javascript:void(0);">
            <h4>Update map settings</h4>
            <div class="form-group input-group mb-3">
              <span class="input-group-text" id="label_opacity" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body"
              data-bs-html="true" data-bs-title='Set the transperency of the layer'>Transparency</span>
              <span class="form-control">
                <input type="range" class="form-range" name="OpacityRange" id="Opacity" min="0" max="100" value="100" oninput="this.form.OpacityNumber.value=this.value"/>
              </span>
              <input type="number" class="form-control" name="OpacityNumber" min="1" max="20" value="1" oninput="this.form.OpacityRange.value=this.value" style="max-width:70px"/>
              <span class="input-group-text">%</span>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

{% endblock content %}

{% block scripts %}
  {% comment %} {{ base_grid|json_script:"base_grid" }} {% endcomment %}
  <script src="{% url 'kombstra:javascript-catalog' %}"></script>
  {% comment %} <script src="https://unpkg.com/vue@3.2.47/dist/vue.global.js"></script>
  <script src="https://unpkg.com/interactjs/dist/interact.min.js"></script> {% endcomment %}
  {% comment %} {% if debug %}
    <script src={% static "kombstra/js/map.js" %} defer></script>
  {%else%}
    <script src={% static "kombstra/js/map.min.js" %} defer></script>
  {% endif%} {% endcomment %}
  <script src={% static "front-end/kombstra.js" %} type="module" ></script>

{% endblock %}
